#tag WindowBegin Window WinMain   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   605   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   True   MaxWidth        =   32000   MenuBar         =   681366093   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   True   Title           =   "FGThumbnailCanvas Demo"   Visible         =   True   Width           =   848   Begin FGThumbnailCanvas MyCanvas      AcceptFocus     =   ""      AcceptTabs      =   ""      AllowMouseWheelScrolling=   True      AutoDeactivate  =   True      Backdrop        =   ""      BackgroundColor =   6776679      CellSize        =   150      CurrentThumbnailUnderMouseIndex=   0      DoubleBuffer    =   True      DownKeyCode     =   31      DragSelectionBorder=   1      DragSelectionBorderColor=   16777215      DragSelectionColor=   16777213      DragSelectionOpacity=   50      DrawSelectionRectangle=   True      Enabled         =   True      EraseBackground =   False      ForceUpdateOnMouseMove=   True      Height          =   605      HelpTag         =   ""      Index           =   -2147483648      InFocus         =   ""      InitialParent   =   ""      InvertMouseWheelScrollDirection=   False      Left            =   224      LeftKeyCode     =   28      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      MaxCellSize     =   300      MaxColumnPadding=   75      MaxRowPadding   =   75      MinCellSize     =   100      MinColumnPadding=   10      MinRowPadding   =   10      RightKeyCode    =   29      Scope           =   0      SelectedBorderColor=   16241766      SelectedBorderThickness=   3      SelectedIndex   =   0      Selecting       =   ""      SelectionCount  =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   0      UpKeyCode       =   30      UseFocusRing    =   True      Visible         =   True      Width           =   608   End   Begin Slider ZoomSlider      AutoDeactivate  =   True      Enabled         =   True      Height          =   23      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   5      LineStep        =   1      LiveScroll      =   True      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   False      Maximum         =   300      Minimum         =   100      PageStep        =   20      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TickStyle       =   0      Top             =   582      Value           =   150      Visible         =   True      Width           =   214   End   Begin ScrollBar MyScrollBar      AcceptFocus     =   true      AutoDeactivate  =   True      Enabled         =   True      Height          =   577      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   832      LineStep        =   1      LiveScroll      =   True      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   True      Maximum         =   100      Minimum         =   0      PageStep        =   20      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Top             =   0      Value           =   0      Visible         =   True      Width           =   16   End   Begin CheckBox CheckboxDrawFlag      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Draw flag when over thumbnail"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   5      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      State           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   54      Underline       =   ""      Value           =   False      Visible         =   True      Width           =   207   End   Begin CheckBox CheckboxInvertOnSelection      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Invert image when selected"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   5      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      State           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   86      Underline       =   ""      Value           =   False      Visible         =   True      Width           =   207   End   Begin CheckBox CheckboxDrawSelectionRectangle      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Draw selection rectangle?"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   5      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      State           =   1      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   168      Underline       =   ""      Value           =   True      Visible         =   True      Width           =   207   End   Begin HorizontalLine HorizontalLine1      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      DoubleBuffer    =   ""      Enabled         =   True      EraseBackground =   ""      Height          =   10      Index           =   -2147483648      InitialParent   =   ""      Left            =   4      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   ""      Top             =   150      UseFocusRing    =   ""      Visible         =   True      Width           =   216   End   Begin TextField BorderThickness      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   126      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Mask            =   "##"      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      Text            =   3      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   194      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   35   End   Begin Label Label1      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   25      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Border thickness:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   194      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   98   End   Begin Label Label2      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   25      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   10      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Border colour:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   224      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   89   End   Begin Rectangle BorderColour      AutoDeactivate  =   True      BorderWidth     =   1      BottomRightColor=   0      Enabled         =   True      FillColor       =   16241766      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   126      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   12      TabPanelIndex   =   0      TabStop         =   True      Top             =   223      TopLeftColor    =   0      Visible         =   True      Width           =   59   End   Begin HorizontalLine HorizontalLine2      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      DoubleBuffer    =   ""      Enabled         =   True      EraseBackground =   ""      Height          =   10      Index           =   -2147483648      InitialParent   =   ""      Left            =   5      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   14      TabPanelIndex   =   0      TabStop         =   ""      Top             =   255      UseFocusRing    =   ""      Visible         =   True      Width           =   216   End   Begin Label Label3      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   14      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   15      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Drag selection rectangle:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   277      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   198   End   Begin Rectangle DragBorderColour      AutoDeactivate  =   True      BorderWidth     =   1      BottomRightColor=   0      Enabled         =   True      FillColor       =   16777215      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   134      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   16      TabPanelIndex   =   0      TabStop         =   True      Top             =   338      TopLeftColor    =   0      Visible         =   True      Width           =   59   End   Begin TextField DragBorderThickness      AcceptTabs      =   ""      Alignment       =   2      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      Italic          =   ""      Left            =   134      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Mask            =   "##"      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   17      TabPanelIndex   =   0      TabStop         =   True      Text            =   1      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   308      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   35   End   Begin Label Label4      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   25      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   18      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Border colour:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   339      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   97   End   Begin Label Label5      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   25      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   19      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Border thickness:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   309      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   106   End   Begin TextField DragOpacity      AcceptTabs      =   ""      Alignment       =   2      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      Italic          =   ""      Left            =   134      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Mask            =   "###"      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   20      TabPanelIndex   =   0      TabStop         =   True      Text            =   50      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   404      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   44   End   Begin Label LabelDragOpacity      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   25      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   21      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Opacity (Mac only):"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   404      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   106   End   Begin Label LabelDragPercent      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   182      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   22      TabPanelIndex   =   0      TabStop         =   True      Text            =   "%"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   404      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   13   End   Begin Rectangle DragBorderColour1      AutoDeactivate  =   True      BorderWidth     =   1      BottomRightColor=   0      Enabled         =   True      FillColor       =   16777215      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   134      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   23      TabPanelIndex   =   0      TabStop         =   True      Top             =   371      TopLeftColor    =   0      Visible         =   True      Width           =   59   End   Begin Label Label8      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   25      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   24      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Fill colour:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   372      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   97   End   Begin Timer ClearFocusTimer      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   -40      LockedInPosition=   False      Mode            =   1      Period          =   1      Scope           =   0      TabIndex        =   22      TabPanelIndex   =   0      TabStop         =   True      Top             =   532      Width           =   32   End   Begin HorizontalLine HorizontalLine3      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      DoubleBuffer    =   ""      Enabled         =   True      EraseBackground =   ""      Height          =   10      Index           =   -2147483648      InitialParent   =   ""      Left            =   5      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   26      TabPanelIndex   =   0      TabStop         =   ""      Top             =   436      UseFocusRing    =   ""      Visible         =   True      Width           =   216   End   Begin Label Info      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   35      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   5      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   28      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Info"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   9      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   214   End   Begin CheckBox CheckboxForceUpdateOnMouseMove      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Update canvas on mouse move?"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   5      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      State           =   1      TabIndex        =   29      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   118      Underline       =   ""      Value           =   True      Visible         =   True      Width           =   207   End   Begin PushButton ButtonSelectAll      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Select All"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   14      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   25      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   458      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PushButton ButtonDeselectAll      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Deselect All"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   106      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   27      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   458      Underline       =   ""      Visible         =   True      Width           =   101   End   Begin Canvas ArrowCanvas      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   1973533660      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   100      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   5      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   False      Scope           =   0      TabIndex        =   30      TabPanelIndex   =   0      TabStop         =   True      Top             =   480      UseFocusRing    =   False      Visible         =   True      Width           =   200   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  // Place the window		  Left = 50		  Top = 50		  		  SetupCanvas()		  		  #if TargetWin32		    LabelDragOpacity.TextColor = &c999999		    LabelDragOpacity.Enabled = false		    LabelDragPercent.TextColor = &c999999		    LabelDragPercent.Enabled = false		    DragOpacity.Enabled = false		  #endif		  		  ClearFocusTimer.Enabled = true ' this is just to get around an RB bug and clear the textfield focus on launch (nothing to do with FGThumbnailCanvas)		  		End Sub	#tag EndEvent	#tag Method, Flags = &h21		Private Sub SetupCanvas()		  dim rand as new Random		  dim a as integer		  dim f as folderItem		  		  for a = 1 to 1000		    select case rand.InRange(1, 10)		    case 1		      MyCanvas.AddThumbnail( new PhotoThumbnail(GetFolderItem("").Child("Images").Child("1.jpg"), "Image " + Str(a)) )		    case 2		      MyCanvas.AddThumbnail( new PhotoThumbnail(GetFolderItem("").Child("Images").Child("2.jpg"), "Image " + Str(a)) )		    case 3		      MyCanvas.AddThumbnail( new PhotoThumbnail(GetFolderItem("").Child("Images").Child("3.jpg"), "Image " + Str(a)) )		    case 4		      MyCanvas.AddThumbnail( new PhotoThumbnail(GetFolderItem("").Child("Images").Child("4.jpg"), "Image " + Str(a)) )		    case 5		      MyCanvas.AddThumbnail( new PhotoThumbnail(GetFolderItem("").Child("Images").Child("5.jpg"), "Image " + Str(a)) )		    case 6		      MyCanvas.AddThumbnail( new PhotoThumbnail(GetFolderItem("").Child("Images").Child("6.jpg"), "Image " + Str(a)) )		    case 7		      MyCanvas.AddThumbnail( new PhotoThumbnail(GetFolderItem("").Child("Images").Child("7.jpg"), "Image " + Str(a)) )		    case 8		      MyCanvas.AddThumbnail( new PhotoThumbnail(GetFolderItem("").Child("Images").Child("8.jpg"), "Image " + Str(a)) )		    case 9		      MyCanvas.AddThumbnail( new PhotoThumbnail(GetFolderItem("").Child("Images").Child("9.jpg"), "Image " + Str(a)) )		    case 10		      MyCanvas.AddThumbnail( new PhotoThumbnail(GetFolderItem("").Child("Images").Child("10.jpg"), "Image " + Str(a)) )		    end select		  next a		  		  MyCanvas.Update()		  		End Sub	#tag EndMethod	#tag Property, Flags = &h0		DrawFlagWhenHovering As Boolean = False	#tag EndProperty	#tag Property, Flags = &h0		InvertThumbnailWhenSelected As Boolean = False	#tag EndProperty#tag EndWindowCode#tag Events MyCanvas	#tag Event		Sub ScrollValueChanged(NewValue as Integer)		  MyScrollBar.Value = newValue		End Sub	#tag EndEvent	#tag Event		Sub MaxScrollValueChanged(NewMaximum as Integer, NewPageStep as Integer)		  MyScrollBar.Maximum = newMaximum		  MyScrollBar.PageStep = newPageStep		  		End Sub	#tag EndEvent	#tag Event		Sub MouseDrag(X as Integer, Y as Integer, Thumbnails() as FGThumbnailClass)		  dim di as DragItem		  dim i as integer		  dim r as BoundsRectangle		  		  if thumbnails.Ubound < 0 then return		  		  r = thumbnails(0).Bounds()		  		  di = new DragItem(self, r.left + me.Left, r.Top + me.Top, r.Width, r.Height)		  		  for i = 1 to thumbnails.Ubound		    r = thumbnails(i).Bounds()		    di.AddItem(r.Left + me.Left, r.Top + me.Top, r.Width, r.Height)		    di.Picture = thumbnails(i).Image		  next i		  		  di.Drag()		  		End Sub	#tag EndEvent	#tag Event		Function ClickedThumbnail(Thumbnail as FGThumbnailClass, ContextualClick as Boolean = False, X as Integer = -1, Y as Integer = -1) As Boolean		  // We've clicked a thumbnail.		  		  // How many are selected?		  if me.SelectionCount = 1 and thumbnail <> nil then ' just the one		    if contextualClick then		      Info.Text = "Right clicked on " + PhotoThumbnail(thumbnail).Text		    else		      Info.Text = "Clicked on " + PhotoThumbnail(thumbnail).Text		    end if		  elseif me.SelectionCount > 1 then ' clicked on a thumbnail but multiple thumbnails are selected		    // We can access the thumbnails clicked on from the MyCanvas.SelectedThumbnails() array		    if contextualClick then		      Info.Text = "Right clicked on multiple selection (" + Str(me.SelectionCount) + " thumbnails)"		    else		      Info.Text = "Clicked on multiple selection (" + Str(me.SelectionCount) + " thumbnails)"		    end if		  end if		  		  // If we've clicked on a thumbnail then stop the selection rectangle being drawn so we can allow dragging		  if thumbnail = nil then		    return false		  else		    return true		  end if		  		End Function	#tag EndEvent	#tag Event		Sub SelectionChanged()		  Info.Text = "Selection changed (" + Str(me.SelectionCount) + " thumbnails selected)"		  		End Sub	#tag EndEvent	#tag Event		Sub MouseMove(X as Integer, Y as Integer)		  if MyCanvas.CurrentThumbnailUnderMouseIndex <> - 1 then		    Info.Text = "Hovering over image " + Str(MyCanvas.CurrentThumbnailUnderMouseIndex+1)		  else		    Info.Text = ""		  end if		  		End Sub	#tag EndEvent#tag EndEvents#tag Events ZoomSlider	#tag Event		Sub ValueChanged()		  MyCanvas.CellSize = me.Value		  MyCanvas.Update()		End Sub	#tag EndEvent#tag EndEvents#tag Events MyScrollBar	#tag Event		Sub ValueChanged()		  MyCanvas.ScrollToRow(me.Value)		  		End Sub	#tag EndEvent#tag EndEvents#tag Events CheckboxDrawFlag	#tag Event		Sub Action()		  DrawFlagWhenHovering = me.Value		  MyCanvas.Update(true)		End Sub	#tag EndEvent#tag EndEvents#tag Events CheckboxInvertOnSelection	#tag Event		Sub Action()		  InvertThumbnailWhenSelected = me.Value		  MyCanvas.Update(true)		End Sub	#tag EndEvent#tag EndEvents#tag Events CheckboxDrawSelectionRectangle	#tag Event		Sub Action()		  MyCanvas.DrawSelectionRectangle = me.Value		  MyCanvas.Update(true)		End Sub	#tag EndEvent#tag EndEvents#tag Events BorderThickness	#tag Event		Sub TextChange()		  MyCanvas.SelectedBorderThickness = Val(me.Text)		  MyCanvas.Update(true)		  		End Sub	#tag EndEvent#tag EndEvents#tag Events BorderColour	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  return true		  		End Function	#tag EndEvent	#tag Event		Sub MouseUp(X As Integer, Y As Integer)		  dim b as boolean		  dim c as Color = me.FillColor		  		  b = SelectColor(c, "Choose a border colour")		  		  me.FillColor = c		  MyCanvas.SelectedBorderColor = c		  		  if b = true then MyCanvas.Update(true)		  		End Sub	#tag EndEvent#tag EndEvents#tag Events DragBorderColour	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  return true		  		End Function	#tag EndEvent	#tag Event		Sub MouseUp(X As Integer, Y As Integer)		  dim b as boolean		  dim c as Color = me.FillColor		  		  b = SelectColor(c, "Choose a border colour")		  		  me.FillColor = c		  MyCanvas.DragSelectionBorderColor = c		  		  if b = true then MyCanvas.Update(true)		  		End Sub	#tag EndEvent#tag EndEvents#tag Events DragBorderThickness	#tag Event		Sub TextChange()		  MyCanvas.DragSelectionBorder = Val(me.Text)		  MyCanvas.Update(true)		  		End Sub	#tag EndEvent#tag EndEvents#tag Events DragOpacity	#tag Event		Sub TextChange()		  MyCanvas.DragSelectionOpacity = Val(me.Text)		  MyCanvas.Update(true)		  		End Sub	#tag EndEvent#tag EndEvents#tag Events DragBorderColour1	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  return true		  		End Function	#tag EndEvent	#tag Event		Sub MouseUp(X As Integer, Y As Integer)		  dim b as boolean		  dim c as Color = me.FillColor		  		  b = SelectColor(c, "Choose a fill colour")		  		  me.FillColor = c		  MyCanvas.DragSelectionColor = c		  		  if b = true then MyCanvas.Update(true)		  		End Sub	#tag EndEvent#tag EndEvents#tag Events ClearFocusTimer	#tag Event		Sub Action()		  // This isn't needed for the FGThumbnailCanvas.  It's only needed to clear the focus from the textfields on Mac when first launching (RB bug)		  		  ClearFocus()		End Sub	#tag EndEvent#tag EndEvents#tag Events CheckboxForceUpdateOnMouseMove	#tag Event		Sub Action()		  MyCanvas.ForceUpdateOnMouseMove = me.Value		  MyCanvas.Update(true)		End Sub	#tag EndEvent#tag EndEvents#tag Events ButtonSelectAll	#tag Event		Sub Action()		  MyCanvas.SelectAll()		  		End Sub	#tag EndEvent#tag EndEvents#tag Events ButtonDeselectAll	#tag Event		Sub Action()		  MyCanvas.DeselectAll()		  		End Sub	#tag EndEvent#tag EndEvents